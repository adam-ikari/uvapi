# DSL 设计哲学

## 声明式原则

声明式 DSL 的核心在于**"描述是什么"**，而不是**"怎么做"**。

关键判断标准：**是否有动作？**

- **命令式**：包含动作，描述"怎么做"
  ```cpp
  param.setValue(1);      // 动作：设置值
  param.setRange(1, 100); // 动作：设置范围
  param.validate();       // 动作：执行验证
  ```

- **声明式**：只描述，没有动作
  ```cpp
  ParamGroup params = {
      range(Int("page", false, 1), 1, 1000),
      range(Int("limit", false, 10), 1, 100)
  };
  ```

## 设计哲学

1. **声明式**：参数声明在前，处理函数在后
2. **自动解析参数**：框架自动解析和类型转换
3. **自动校验**：框架自动验证参数

## 声明式 vs 命令式

### 链式调用也可以是声明式

链式调用 ≠ 命令式

判断标准：
- 链式调用 + 无动作 = 声明式
- 链式调用 + 有动作 = 命令式

示例：

**声明式链式调用**：
```cpp
queryParam<int>("page")
    .optional()          // 描述：是可选的
    .defaultValue(1)     // 描述：默认值是1
    .range(1, 1000);     // 描述：范围是[1, 1000]
```

**命令式链式调用**：
```cpp
builder.addParam("page")    // 动作：添加参数
       .setOptional()        // 动作：设置为可选
       .setDefault(1);       // 动作：设置默认值
```

## 优势

1. **清晰性**：一眼看出参数的属性
2. **可组合性**：可以自由组合描述
3. **无副作用**：描述不会产生副作用
4. **易于测试**：描述可以独立测试
5. **符合直觉**：「声明在前，处理在后」